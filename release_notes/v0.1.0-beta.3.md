# Release Notes - v0.1.0-beta.3

**Release Date:** February 20, 2026  
**Type:** Beta Pre-Release (Major Feature Update)  
**Status:** Testing & Feedback  
**Previous Version:** v0.1.0-beta.2 (February 17, 2026)

---

## ðŸŽ‰ What's New in Beta 3

This release introduces **complete TOTP 2FA authentication** and **extensive test coverage** improvements. Beta 3 is a major feature release focused on security, reliability, and production readiness.

**Highlights:**
- ðŸ” **Complete TOTP 2FA System** (7 backend endpoints, full frontend UI, 3 authentication modes)
- âœ… **Test Coverage Expansion** (85+ passing tests, 103+ total tests with full TOTP coverage)
- ðŸ“š **Deployment Documentation** (10 comprehensive guides for production use)
- ðŸ›¡ï¸ **Security Improvements** (TOTP secret encryption, rate limiting, hardening docs)

---

## ðŸ” TOTP Two-Factor Authentication (NEW)

### What It Does

TOTP (Time-based One-Time Password) adds an extra layer of security using authenticator apps like:
- Google Authenticator
- Microsoft Authenticator
- Authy
- 1Password
- Bitwarden

### Three Authentication Modes

1. **2FA Only** - Required at every login (like Google/GitHub 2FA)
2. **Recovery Only** - Alternative to recovery codes for password reset
3. **Both** - Required at login AND available for recovery (maximum security)

### Backend Implementation

**7 New API Endpoints:**
- `POST /auth/totp/setup` - Generate secret and QR code
- `POST /auth/totp/verify-setup` - Enable TOTP with first code
- `POST /auth/totp/verify` - Verify code during login
- `POST /auth/totp/recover` - Reset password using TOTP
- `PUT /auth/totp/mode` - Change authentication mode
- `DELETE /auth/totp` - Disable TOTP
- `GET /auth/totp/status` - Get current configuration

**Security Features:**
- Secrets encrypted at rest using XChaCha20-Poly1305 AEAD cipher
- 30-second time windows with Â±1 step tolerance
- Rate limiting (max 5 failed attempts before timeout)
- Partial JWT tokens for two-step authentication
- Failed attempt tracking and automatic lockout

### Frontend Integration

**Setup Wizard:**
- Scan QR code with authenticator app
- Manual secret entry option for app compatibility
- Choose authentication mode (2FA only, recovery only, both)
- Test code verification before enabling

**Login Flow:**
1. Enter username and password
2. If TOTP enabled â†’ enter 6-digit code from authenticator app
3. Success â†’ full access granted

**Password Recovery:**
- Use TOTP code as alternative to recovery codes
- No need to store recovery codes if TOTP is configured
- Available in "Recovery Only" or "Both" modes

**Settings Management:**
- View TOTP status (enabled/disabled, last used)
- Change authentication mode anytime
- Disable TOTP with password confirmation
- Re-enable with new secret

---

## âœ… Test Coverage Improvements

### Test Statistics

- **103+ total tests** across backend and authentication
- **85+ passing tests** (user-validated metric)
- Comprehensive TOTP test coverage (unit + integration tests)

### Test Breakdown

| Test Suite | Count | Coverage |
|------------|-------|----------|
| Database operations | 41 | Full CRUD, organizers, users |
| Authentication | 30 | JWT, passwords, TOTP flows |
| API integration | 18 | All endpoints, error handling |
| Models | 9 | Serialization, validation |
| TOTP module | 10 | Generation, encryption, verification |
| Integration | 2 | End-to-end flows |

### TOTP-Specific Tests

- TOTP secret generation and encryption
- Code verification with time skew tolerance
- Mode handling (2fa_only, recovery_only, both)
- Login flow with partial tokens
- Recovery flow (password reset via TOTP)
- Rate limiting on failed attempts
- QR code generation
- Secret encryption/decryption at rest

---

## ðŸ“š Deployment Documentation (10 Guides)

New documentation in `docs/deployment/`:

1. **README.md** - Overview and guide index
2. **quickstart.md** - Fast Docker Compose setup
3. **database-production.md** - PostgreSQL production tuning
4. **reverse-proxy-nginx.md** - Nginx SSL/TLS configuration
5. **reverse-proxy-caddy.md** - Caddy automatic HTTPS
6. **reverse-proxy-traefik.md** - Traefik service mesh integration
7. **security-hardening.md** - Security best practices
8. **monitoring-logging.md** - Prometheus/Grafana setup
9. **high-availability.md** - HA deployment patterns
10. **troubleshooting.md** - Common issues and solutions

**Topics Covered:**
- Production PostgreSQL configuration and backups
- SSL/TLS termination for all major reverse proxies
- Security hardening (CSP, secrets management, rate limiting)
- Monitoring and alerting with Prometheus/Grafana
- Log aggregation with ELK/Loki
- High availability with load balancers and DB replication
- Common deployment issues and resolutions

---

## ðŸš€ What's Included (Carried Over from Beta 1 & 2)

All features from previous releases are included:

- âœ… Multi-inventory management with data isolation
- âœ… Item tracking with images, categories, tags, custom fields
- âœ… User authentication with JWT tokens and Argon2 password hashing
- âœ… Recovery codes for account recovery
- âœ… Backup/restore functionality (JSON export/import)
- âœ… Docker deployment with PostgreSQL database
- âœ… RESTful API with rate limiting
- âœ… Responsive web interface with dark mode
- âœ… PWA support with enhanced icons (from beta.2)
- âœ… DOM-based XSS vulnerability fixes (from beta.2)

See previous release notes:
- [v0.1.0-beta.2 release notes](v0.1.0-beta.2.md)
- [v0.1.0-beta.1 release notes](v0.1.0-beta.1.md)

---

## ðŸ“¦ Installation

### Option 1: Pre-built Image from GHCR (Recommended)

```bash
# Download production compose file
curl -sSL https://raw.githubusercontent.com/VictoryTek/home-registry/main/docker-compose.prod.yml -o docker-compose.yml

# Start the application with beta.3
VERSION=0.1.0-beta.3 docker compose up -d

# Access at http://localhost:8210
```

### Option 2: Use Latest Beta Tag

```bash
# Pull latest beta version (automatically points to beta.3)
docker pull ghcr.io/victorytek/home-registry:beta

# Or use specific version
docker pull ghcr.io/victorytek/home-registry:0.1.0-beta.3
```

### Option 3: Build from Source

```bash
# Clone repository
git clone https://github.com/VictoryTek/home-registry.git
cd home-registry
git checkout v0.1.0-beta.3

# Start with Docker Compose
docker compose up -d

# Access at http://localhost:8210
```

---

## ðŸ”„ Upgrading from Beta 2

**Good News:** This upgrade includes a new database migration (V023) but is backwards-compatible!

### Automatic Migration

```bash
# Stop existing containers
docker compose down

# Pull new version
docker pull ghcr.io/victorytek/home-registry:0.1.0-beta.3

# Update compose file to use new version
VERSION=0.1.0-beta.3 docker compose up -d

# Migration V023 (TOTP settings table) will run automatically on startup
```

**Migration Details:**
- Creates `totp_settings` table for TOTP configuration storage
- No data loss - all existing data preserved
- TOTP is **opt-in** - existing users will not be affected
- Users can enable TOTP from Settings â†’ Two-Factor Authentication

### Breaking Changes

**None.** This is a fully backwards-compatible release.

---

## âš ï¸ Known Issues & Limitations

### Beta Limitations (Carried Over)

1. **No Multi-User Collaboration:** Sharing inventories with other users is not yet implemented (framework in place)
2. **Limited Mobile Optimization:** Mobile UI works but desktop experience is better
3. **No Bulk Operations:** Cannot edit or delete multiple items at once
4. **Search Functionality:** Basic search only - no advanced filters
5. **Image Management:** Single image per item (no galleries)

### New Considerations (Beta 3)

1. **TOTP Backup:** If you lose your authenticator device and don't use recovery codes, you'll lose account access
   - **Mitigation:** Use "Both" mode to require TOTP at login AND have recovery option
   - **Best Practice:** Generate recovery codes AND enable TOTP

2. **TOTP Secret Recovery:** Once TOTP is enabled, the QR code cannot be retrieved
   - **Mitigation:** Save QR code or manual secret during initial setup
   - **Workaround:** Disable and re-enable TOTP to generate new secret

3. **Rate Limiting:** 5 failed TOTP attempts locks out the user temporarily
   - **Purpose:** Prevents brute-force attacks
   - **Duration:** Timeout resets after cooling-off period

### Performance Notes

- **First Load:** Initial image loads may be slow (no CDN caching)
- **Large Inventories:** Performance untested with >1000 items per inventory
- **Concurrent Users:** Session management tested with <20 concurrent users

---

## ðŸ”’ Security Notes

### New Security Features (Beta 3)

âœ… TOTP secret encryption using XChaCha20-Poly1305 AEAD  
âœ… Rate limiting on TOTP verification (max 5 attempts)  
âœ… Partial JWT tokens for two-step authentication flow  
âœ… TOTP recovery reduces attack surface (no need to store recovery codes)  
âœ… Security hardening documentation (CSP, secrets management)  

### What's Secure (Carried Over)

âœ… Passwords hashed with Argon2id  
âœ… HTTPS ready (configure reverse proxy)  
âœ… Rate limiting enabled (100 RPS)  
âœ… SQL injection protection  
âœ… XSS prevention (DOM-based XSS fixed in beta.2)  
âœ… Non-root Docker container  
âœ… Minimal attack surface (Alpine Linux, no shell)  

### Security Recommendations

1. **Enable TOTP:** Use "Both" mode for maximum security
2. **Use Strong Passwords:** 16+ characters with mixed case, numbers, symbols
3. **Backup Recovery Codes:** Store in password manager or print securely
4. **Deploy Behind Reverse Proxy:** Use Nginx/Caddy/Traefik with SSL/TLS
5. **Follow Hardening Guide:** See `docs/deployment/security-hardening.md`
6. **Monitor Logs:** Track failed TOTP attempts and suspicious activity

---

## ðŸ› ï¸ Technical Details

### Backend

- **Language:** Rust 1.88+
- **Framework:** Actix-Web 4.12.1
- **Database:** PostgreSQL 16+ (migration V023 required)
- **Async Runtime:** Tokio
- **Crypto:** XChaCha20-Poly1305 (TOTP encryption), Argon2id (passwords)
- **TOTP Library:** totp-rs with SHA-1 algorithm (industry standard)

### Frontend

- **Framework:** React 18 + TypeScript 5.6
- **Build Tool:** Vite 6.4
- **Styling:** Custom CSS with CSS variables
- **State Management:** Context API
- **PWA:** Vite PWA plugin with service worker

### DevOps

- **Container:** Multi-stage Docker build with Alpine Linux (23MB final image)
- **CI/CD:** GitHub Actions with preflight checks
- **Registry:** GitHub Container Registry (GHCR)
- **Architectures:** linux/amd64, linux/arm64
- **Tests:** 103+ comprehensive tests with cargo test + actix-web::test

---

## ðŸŽ¯ First-Time Setup (Updated)

1. Open http://localhost:8210
2. Complete 3-step setup wizard:
   - **Step 1:** Create admin account (username, full name, password)
   - **Step 2:** Configure 2FA settings (optional - skip if not needed)
   - **Step 3:** Save recovery codes (print or store securely)
3. Log in with your credentials
4. **Optional:** Enable TOTP from Settings â†’ Two-Factor Authentication
5. Create your first inventory from the dashboard

**New in Beta 3:**
- TOTP can be enabled after initial setup from Settings page
- Choose authentication mode based on your security needs
- Recovery codes are still recommended even with TOTP enabled

---

## ðŸ“ Changelog Summary

For full changelog, see [CHANGELOG.md](../CHANGELOG.md#010-beta3---2026-02-20)

**Major Changes:**
- âž• Complete TOTP 2FA authentication system (7 endpoints, full UI)
- âž• 103+ comprehensive tests with 85+ passing
- âž• 10 deployment guides for production use
- ðŸ”’ TOTP secret encryption and rate limiting
- ðŸ“š Security hardening and troubleshooting documentation

---

## ðŸ¤ Contributing

This is a beta release. Please report issues on GitHub:
- **Issues:** https://github.com/VictoryTek/home-registry/issues
- **Discussions:** https://github.com/VictoryTek/home-registry/discussions
- **Security:** Responsible disclosure via security@victorytek.com

---

## ðŸ“„ License

MIT License - See [LICENSE](../LICENSE) for details

---

## ðŸ”— Links

- **GitHub Repository:** https://github.com/VictoryTek/home-registry
- **GHCR Images:** https://github.com/VictoryTek/home-registry/pkgs/container/home-registry
- **Documentation:** https://github.com/VictoryTek/home-registry/tree/main/docs
- **Previous Releases:**
  - [v0.1.0-beta.2](v0.1.0-beta.2.md)
  - [v0.1.0-beta.1](v0.1.0-beta.1.md)
