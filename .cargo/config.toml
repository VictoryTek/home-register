# Cargo configuration
# https://doc.rust-lang.org/cargo/reference/config.html

[alias]
# Lint with all warnings as errors
lint = "clippy --all-targets --all-features -- -D warnings"
# Format check (CI mode)
fmt-check = "fmt -- --check"
# Run all checks
check-all = "check --all-targets --all-features"
# Audit dependencies
audit = "deny check"
# Run preflight checks (mirrors CI pipeline)
preflight = "!powershell -ExecutionPolicy Bypass -File scripts/preflight.ps1"

[build]
# Enable incremental compilation for faster dev builds
incremental = true

[target.x86_64-unknown-linux-gnu]
# Use mold linker if available for faster linking (optional)
# linker = "clang"
# rustflags = ["-C", "link-arg=-fuse-ld=mold"]

[env]
# Ensure RUST_BACKTRACE is available in builds
RUST_BACKTRACE = { value = "1", force = false }
# Test database connection string
TEST_DATABASE_URL = "postgres://postgres:uK8m3NvQ7wPxRj2Y5tLz@localhost:5432/home_inventory_test"

[profile.dev]
# Faster dev builds with some optimization
opt-level = 0
debug = true

[profile.release]
# Optimized release builds
opt-level = 3
lto = "thin"
codegen-units = 1
strip = true
debug = false
